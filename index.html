<!DOCTYPE html>
<html lang="en">

<head>
      <title>JS Scope Visualizer</title>
      <meta charset="utf-8">
      <meta name="description"
            content="JS Scope visualizer for learning purposes">
      <meta name="author"
            content="Marcos NASA G">
      <meta name="keywords"
            content="JS, JavaScript, Scope, Visualizer">
      <meta name="viewport"
            content="width=device-width, initial-scale=1">
      <meta name="theme-color"
            content="#101014">
      <meta property="og:title"
            content="JS Scope Visualizer" />
      <meta property="og:type"
            content="website" />
      <meta property="og:url"
            content="https://js-scope-visualizer.firebaseapp.com/" />
      <meta property="og:image"
            content="./assets/images/ecma-logo.png" />
      <meta property="og:description"
            content="JavaScript scope visualizer for learning purposes." />
      <meta name="google-site-verification"
            content="gvKWYmQUE8lmdKnFioI3pSYK5ykGG3KWrHjqC2wXdkY" />
      <link rel="canonical"
            href="https://js-scope-visualizer.firebaseapp.com/" />
      <link rel="shortcut icon"
            type="image/x-icon"
            href="./assets/icons/favicon.ico" />
      <link rel="apple-touch-icon"
            href="./assets/icons/favicon.ico">
      <link href="lib/codemirror.css"
            rel="preload"
            as="style"
            onload="this.onload=null;this.rel='stylesheet'">
      <link href="./src/app/styles.css"
            rel="stylesheet">
      <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300&display=swap"
            rel="preload"
            as="style"
            onload="this.onload=null;this.rel='stylesheet'">
      <link href="./src/app/styles/code.css"
            rel="preload"
            as="style"
            onload="this.onload=null;this.rel='stylesheet'">
      <link href="./src/app/styles/visualizer.css"
            rel="preload"
            as="style"
            onload="this.onload=null;this.rel='stylesheet'">
      <link href="./src/app/styles/scope-theory.css"
            rel="preload"
            as="style"
            onload="this.onload=null;this.rel='stylesheet'">
      <link href="./src/app/styles/mediaqueries.css"
            rel="stylesheet">
      <noscript>
            <link href="lib/codemirror.css"
                  rel="stylesheet">
            <link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap"
                  rel="stylesheet">
            <link href="./src/app/styles/code.css"
                  rel="stylesheet">
            <link href="./src/app/styles/visualizer.css"
                  rel="stylesheet">
            <link href="./src/app/styles/scope-theory.css"
                  rel="stylesheet">
      </noscript>
      <script src="lib/keywords.js"
              async></script>
      <script src="lib/prettier.js"
              async></script>
      <script src="lib/parser-babel.js"
              async></script>
      <script src="lib/esprima.js"
              async></script>
      <script src="lib/lib.js"
              async></script>
      <script src="lib/codemirror.js"
              defer></script>
      <script src="lib/javascript.js"
              defer></script>
      <script src="./src/app/main.js"
              defer></script>
      <script>
            if ('serviceWorker' in navigator) {
                  navigator.serviceWorker.register('/service-worker.js', {
                        scope: './'
                  });
            }
      </script>
      <link rel="manifest"
            href="./manifest.json">
</head>

<body class="app">
      <header class="header">
            <h1 class="header__title">JS Scope Visualizer</h1>

            <nav class="nav-bar">
                  <ul class="nav-bar__list">
                        <li class="nav-bar__item">
                              <a class="nav-bar__link spa-link"
                                 data-target="visualizer"
                                 tabindex="0">
                                    <svg xmlns="http://www.w3.org/2000/svg"
                                         class="nav-bar__icon"
                                         height="24"
                                         viewBox="0 0 24 24"
                                         width="24"
                                         role="img">
                                          <title id="homeTitle">Scope Visualizer</title>
                                          <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"
                                                fill="#f5f5f5" />
                                    </svg>
                                    Scope Visualizer
                              </a>
                        </li>
                        <li class="nav-bar__item">
                              <a class="nav-bar__link spa-link"
                                 data-target="scope-theory"
                                 tabindex="0">
                                    <svg xmlns="http://www.w3.org/2000/svg"
                                         enable-background="new 0 0 24 24"
                                         height="24"
                                         viewBox="0 0 24 24"
                                         width="24"
                                         role="img">
                                          <g>
                                                <path d="M21,5c-1.11-0.35-2.33-0.5-3.5-0.5c-1.95,0-4.05,0.4-5.5,1.5c-1.45-1.1-3.55-1.5-5.5-1.5S2.45,4.9,1,6v14.65 c0,0.25,0.25,0.5,0.5,0.5c0.1,0,0.15-0.05,0.25-0.05C3.1,20.45,5.05,20,6.5,20c1.95,0,4.05,0.4,5.5,1.5c1.35-0.85,3.8-1.5,5.5-1.5 c1.65,0,3.35,0.3,4.75,1.05c0.1,0.05,0.15,0.05,0.25,0.05c0.25,0,0.5-0.25,0.5-0.5V6C22.4,5.55,21.75,5.25,21,5z M21,18.5 c-1.1-0.35-2.3-0.5-3.5-0.5c-1.7,0-4.15,0.65-5.5,1.5V8c1.35-0.85,3.8-1.5,5.5-1.5c1.2,0,2.4,0.15,3.5,0.5V18.5z"
                                                      fill="#f5f5f5" />
                                          </g>
                                    </svg>
                                    Scope Theory
                              </a>
                        </li>
                  </ul>
            </nav>

      </header>
      <textarea id="code-editor"
                class="code-editor__editor"
                name="code-editor"
                aria-label="Code editor"></textarea>
      <main id="visualizer"
            class="custom-code-editor page active">
            <div id="scopes"
                 class="scopes">
            </div>
            <div id="code-displayer"
                 class="custom-code-editor__editor">
            </div>
      </main>
      <article id="scope-theory"
               class="scope-theory page">
            <header>
                  <h2 class="scope-theory__title">
                        JS Scope Theory
                  </h2>
            </header>
            <section class="scope-theory__content">
                  <header>
                        <h3 class="scope-theory__sub-title">
                              What's a block?
                        </h3>
                  </header>
                  <p class="scope-theory__theory">
                        According to the
                        <a href="https://www.ecma-international.org/ecma-262/11.0/"
                           target="_blank"
                           rel="noreferrer"
                           tabindex="0">
                              ECMAScript Language Specification</a>,
                        a block statement is composed by a pair of brackets and a list of statements.
                        <br>
                        If you are familiar with functions or any sort of flow control statement
                        (for loops, if statements, switch statements...), you are already familiar with blocks.
                  </p>
                  <div class="flexbox">
                        <code class="scope-theory__code-snippet">
                              function addOdds(...args) {
                              <span class="scope-theory__code-comment">// 1st block start</span>
                              <br>
                              &nbsp;var total = 0;
                              <br>
                              &nbsp;for (let number of args) {
                              <span class="scope-theory__code-comment"> // 2nd block start</span>
                              <br>
                              &nbsp;&nbsp;if (number % 2== 0) {
                              <span class="scope-theory__code-comment"> // 3rd block start</span>
                              <br>
                              &nbsp;&nbsp;&nbsp;total += number;
                              <br>
                              &nbsp;&nbsp;}
                              <span class="scope-theory__code-comment"> // 3rd block end</span>
                              <br>
                              &nbsp;}
                              <span class="scope-theory__code-comment"> // 2nd block end</span>
                              <br>
                              &nbsp;return total;
                              <br>
                              }
                              <span class="scope-theory__code-comment"> // 1st block end</span>
                        </code>
                  </div>
                  <p class="scope-theory__theory">
                        Blocks allows us to group a set of statements together.
                  </p>
            </section>
            <section class="scope-theory__content">
                  <header>
                        <h3 class="scope-theory__sub-title">
                              What's the Scope?
                        </h3>
                  </header>
                  <p class="scope-theory__theory">
                        The scope can be seen as the set of rules which
                        determines whether a variable is available or not in a specific execution context or region of
                        the code.
                  </p>
                  <p class="scope-theory__theory">
                        JS Scope is <i>lexically</i> determined.
                        <br>
                        This means that the scopes are set before the code execution, during the compilation
                        (<i>lexical</i> comes from the compilation <i>lexing</i> step where the code is split into
                        tokens, the smallest meaningful chunks of information).
                        <br>
                        Knowing this, we can take advantage of this information in order to predict the scopes
                        just from looking at our code!
                  </p>
            </section>
            <section class="scope-theory__content">
                  <header>
                        <h3 class="scope-theory__sub-title">
                              How do we do it?
                        </h3>
                  </header>
                  <p class="scope-theory__theory">
                        The JS engine declares a scope for each block in the code and <i>assigns</i> each variable to
                        the scope where it was declared.
                  </p>
                  <p class="scope-theory__theory">
                        In order to predict the scopes, thus, we will have to think like the JS engine does!
                        <br>
                        Every time we find a block in our code, we will assign a color to it.
                        <br>
                        Every time we find a variable, we will also assign a color to it. But in order to do that,
                        we need to dive into some concepts!
                  </p>
                  <section class="scope-theory__sub-content">
                        <header>
                              <h4 class="scope-theory__sub-title">
                                    Variables: target and source references
                              </h4>
                        </header>
                        <p class="scope-theory__theory">
                              Every variable in our program has one out of two roles: target or source.
                              <br>
                              <i>
                                    In technical documents, target is commonly referred as LHS (left-hand side)
                                    and source is commonly referred as RHS (right-hand side). This terminology
                                    was adapted by computer scientists from maths.
                              </i>
                              <br>
                        </p>
                        <p class="scope-theory__theory">
                              Whenever we assign something to a variable, we say the variable is in a target reference
                              position (or LHS): our variable is the target of the assignment operator.
                              <br>
                              In other words, a source reference to a variable has a <i>writing</i> role:
                              we write a value into the variable.
                        </p>
                        <p class="scope-theory__theory">
                              Whenever we pass a variable as an argument in a function call, we say the variable
                              is in a source reference position (or RHS): our variable is the source of the value for
                              the function parameter.
                              <br>
                              In other words, a target reference to a variable has a <i>reading</i> role:
                              we read the value that the variable holds.
                        </p>
                        <div class="flexbox">
                              <code class="scope-theory__code-snippet">
                                    var array = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9];
                                    <span class="scope-theory__code-comment">
                                          // <i>array</i> is a target reference
                                    </span>
                                    <br>
                                    addOdds(...array);
                                    <span class="scope-theory__code-comment">
                                          // <i>array</i> is a source reference
                                    </span>
                                    <br>
                              </code>
                        </div>
                        <p class="scope-theory__theory">
                              To state it clearly
                              <br>
                              &nbsp;&nbsp;&nbsp;— a target reference is the one where we access a memory address to
                              write a value in
                              it and
                              <br>
                              &nbsp;&nbsp;&nbsp;— a source reference is the one where we access a memory address to read
                              a value
                              from it.
                        </p>
                  </section>
                  <section class="scope-theory__sub-content">
                        <header>
                              <h4 class="scope-theory__sub-title">
                                    Variable declarations
                              </h4>
                        </header>
                        <p class="scope-theory__theory">
                              A variable declaration is a statement that allocates some space in memory to store a
                              value.
                              <br>
                              Formal variable declarations can be easily spotted: in JS, there are 3 keywords which will
                              help us to formally declare a variable: <i>var</i>, <i>const</i> and <i>let</i>.
                              <br>
                              However, there are other variables in the target roles that might join our variable
                              declaration group, as in function parameters or loop declarations.
                        </p>
                        <div class="flexbox">
                              <code class="scope-theory__code-snippet">
                                    function add(a, b) {
                                    <span class="scope-theory__code-comment">
                                          // a and b fulfill the target role and are indeed variable declarations
                                          which will be initialized with the passed arguments at run-time
                                    </span>
                                    <br>
                                    &nbsp;return a + b;
                                    <br>
                                    }
                              </code>
                        </div>
                  </section>
                  <section class="scope-theory__sub-content">
                        <header>
                              <h4 class="scope-theory__sub-title">
                                    Scope & Variables
                              </h4>
                        </header>
                        <p class="scope-theory__theory">
                              The variables declared in a particular scope will only be available inside that
                              scope and the
                              nested ones.
                        </p>
                        <p class="scope-theory__theory">
                              To understand JS scoping rules applied to variables availability, we need to
                              differentiate
                              between function scoped variables and block scoped variables.
                        </p>
                        <p class="scope-theory__theory">
                              Before ES2015, the only way to declare a variable in JS was via the <i>var</i>
                              variable
                              declaration.
                              The <i>var</i> variable declaration declares a <i>function scoped variable</i>.
                              Function scoped variables set the bounds for their availability to the nearest
                              enclosing
                              function and, as we discussed previously, the nested blocks.
                        </p>
                        <p class="scope-theory__theory">
                              ES2015 introduced <i>let</i> and <i>const</i> variable declarations.
                              Both <i>let</i> and <i>const</i> variable declarations declare <i>block scoped
                                    variables</i>.
                              Block scoped variables set the bounds for their availability to the nearest
                              enclosing block
                              (whether it is a function, a pair of brackets, an if statement, a for statement...),
                              and, as we
                              discussed previously, the nested blocks.
                        </p>
                  </section>
                  <p class="scope-theory__theory">
                        The information we need to extract from the previous sub-sections and which will give us the
                        rules to assign a color to our variables can be summarized in two main ideas:
                        <br>
                        &nbsp;&nbsp;&nbsp;— Variable declarations will always have the color of the scope where they are
                        being declared, attending to the differences that using block or function scoped variables might
                        carry. We will always consider function parameters as declarations inside the function scope.
                        <br>
                        &nbsp;&nbsp;&nbsp;— Whenever we find a variable in a source position or a variable in a target
                        position which is considered a variable declaration, we will perform a lookup for its
                        declaration, starting in the current scope all the way up to the global one.
                        We will stop as soon as we find it and will assignt to it the same color it had in its
                        declaration.
                  </p>
                  <p class="scope-theory__theory">
                        With our current knowledge, we should be ready to test our new gained scope analysis skills!
                        <br>
                        Try revisiting our <code>addOdds</code> function
                        and assign a colored bubble to each scope and variable we can find!
                  </p>
                  <details class="scope-theory__spoiler">
                        <summary>Solution</summary>
                        <div class="flexbox">
                              <code class="scope-theory__code-snippet white-bubble">
                                    <span class="scope-theory__code-comment">// global/outer scope start:
                                          WHITE</span>
                                    <br>
                                    function addOdds(...<span class="red-bubble--variable">args</span>) {
                                    <span class="scope-theory__code-comment">// 1st block start</span>
                                    <br>
                                    <span class="red-bubble">
                                          <span class="scope-theory__code-comment--light">
                                                // function scope: RED
                                          </span>
                                          <br>
                                          &nbsp;var total = 0;
                                          <br>
                                          &nbsp;for (let <span class="blue-bubble--variable">number</span> of
                                          args) {
                                          <span class="scope-theory__code-comment--light"> // 2nd block
                                                start</span>
                                          <br>
                                          <span class="blue-bubble">
                                                &nbsp;&nbsp;<span class="scope-theory__code-comment--light">
                                                      // loop scope: BLUE
                                                </span>
                                                <br>
                                                &nbsp;&nbsp;if (<span class="blue-bubble--variable">number</span>
                                                % 2 ==
                                                0) {
                                                <span class="scope-theory__code-comment--light"> // 3rd block
                                                      start</span>
                                                <br>
                                                <span class="green-bubble">
                                                      &nbsp;&nbsp;&nbsp;<span class="scope-theory__code-comment--light">
                                                            // if scope: GREEN
                                                      </span>
                                                      <br>
                                                      &nbsp;&nbsp;&nbsp;<span class="red-bubble--variable">total</span>
                                                      +=
                                                      <span class="blue-bubble--variable">number</span>;
                                                </span>
                                                &nbsp;&nbsp;}
                                                <span class="scope-theory__code-comment--light"> // 3rd block
                                                      end</span>
                                          </span>
                                          &nbsp;}
                                          <span class="scope-theory__code-comment--light"> // 2nd block end</span>
                                          <br>
                                          &nbsp;return total;
                                    </span>
                                    }
                                    <span class="scope-theory__code-comment"> // 1st block end</span>
                                    <br>
                              </code>
                        </div>
                  </details>
            </section>
            <section class="scope-theory__content">
                  <header>
                        <h3 class="scope-theory__sub-title">
                              About this project
                        </h3>
                  </header>
                  <p class="scope-theory__theory">
                        JS Scope Visualizer is the first of the «3 pilars project» inspired by Kyle Simpson.
                        <br>
                        It allows the users to visualize JS Scope as bubbles.
                        <br>
                        The main purpose of this project is helping new JS students to understand the scoping system and
                        is intended for small snippets; however, it should be able to handle any script.
                  </p>
                  <p class="scope-theory__theory">
                        Authored by Marcos NASA G
                        (<a href="https://www.twitter.com/MarcosNASA"
                           target="_blank"
                           rel="noreferrer"
                           tabindex="0">@MarcosNASAG</a>)
                        - 2020.
                  </p>
                  <div class="flexbox">
                        <a class="scope-theory__github-link"
                           href="https://github.com/MarcosNASA"
                           target="_blank"
                           rel="noreferrer"
                           tabindex="0">
                              <svg class="scope-theory__icon"
                                   viewBox="0 0 24 24"
                                   xmlns="http://www.w3.org/2000/svg"
                                   role="img"
                                   fill="#2a313b">
                                    <title>GitHub icon</title>
                                    <path
                                          d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12" />
                              </svg>
                              Check it in GitHub
                        </a>
                  </div>
            </section>
            <section class="scope-theory__content">
                  <header>
                        <h3 class="scope-theory__sub-title">
                              Want to learn more?
                        </h3>
                  </header>
                  <p class="scope-theory__theory">
                        <a href="https://github.com/getify/You-Dont-Know-JS"
                           target="_blank"
                           rel="noreferrer"
                           tabindex="0">You Don't Know JS Yet</a>
                        is a book series by Kyle Simpson
                        (<a href="https://www.twitter.com/getify"
                           target="_blank"
                           rel="noreferrer"
                           tabindex="0">@getify</a>)
                        which dives deep into the core mechanisms of the JavaScript language.
                  </p>
                  <p class="scope-theory__theory">
                        The second chapter of the series
                        (<a href="https://github.com/getify/You-Dont-Know-JS/blob/2nd-ed/scope-closures/README.md"
                           target="_blank"
                           rel="noreferrer"
                           tabindex="0">Scope & Closures</a>)
                        takes a look into how the scoping rules behave in JS.
                  </p>
                  <div class="flexbox">
                        <a class="scope-theory__button"
                           href="https://t.co/PbFmTwxQ9e?amp=1"
                           target="_blank"
                           rel="noreferrer"
                           tabindex="0">
                              Buy it now!
                        </a>
                  </div>
            </section>
      </article>

      <div id="snackbar"
           class="snackbar"></div>
</body>

</html>